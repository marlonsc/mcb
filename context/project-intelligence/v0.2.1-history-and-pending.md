# v0.2.1 History And Pending Closure Matrix

Last updated: 2026-02-11 (America/Sao_Paulo)

## Purpose

Reconstruct v0.2.1 implementation history, reconcile plan docs vs code,
and list pending closure work with source evidence.

## Evidence Base

- Planning docs:
  - `docs/plan/MCB-GAPS-REPORT.md`
  - `docs/plan/MCB-COMPREHENSIVE-GAPS.md`
  - `docs/plan/MCB-VALIDATION-REPORT.md`
  - `docs/plan/OPENCODE-INTEGRATION-PLAN.md`
  - `docs/plan/OPENCODE-MCB-MIGRATION-PLAN.md`
- Release docs:
  - `docs/operations/CHANGELOG.md`
  - `docs/developer/ROADMAP.md`
  - `docs/v030-IMPLEMENTATION.md`
  - `docs/implementation/phase-9-roadmap.md`
- Code checks:
  - `crates/mcb-server/src/handlers/project.rs`
  - `crates/mcb-server/src/handlers/search.rs`
  - `crates/mcb-server/src/handlers/memory/handler.rs`
  - `crates/mcb-server/src/handlers/session/create.rs`
  - `crates/mcb-server/src/handlers/vcs/list_repos.rs`
  - `crates/mcb-providers/src/database/sqlite/memory_repository.rs`
  - `crates/mcb-application/src/use_cases/memory_service.rs`
  - `crates/mcb-providers/src/cache/moka.rs`
  - `crates/mcb-domain/src/ports/infrastructure/lock.rs`
- Branch history: `release/v0.2.1` through commit `347fefdc`.

## Historical Timeline

1. 2026-02-08: gap and migration docs reported multiple P0/P1 blockers.
2. 2026-02-09/10: release history shows handler and gap-fix work landed.
3. 2026-02-10: `v0.2.0` tag and changelog report stabilization and
   `gap_fixes_e2e.rs` coverage.
4. 2026-02-11: branch received admin feature commits and context-hierarchy
   commit `347fefdc`.

## Reconciliation Matrix

- Project handler fully stubbed
  - Evidence: `project.rs` implements list/get for project resource.
  - Status: Partial.
- Context search resource missing
  - Evidence: `SearchResource::Context` plus handler branch exists.
  - Status: Implemented.
- ErrorPattern memory not implemented
  - Evidence: memory handler and service implement store/search paths.
  - Status: Implemented.
- VCS list returned collections
  - Evidence: `list_repos.rs` uses `VcsProvider::list_repositories`.
  - Status: Implemented.
- Memory FK parent instability
  - Evidence: SQLite repo ensures org/project before inserts.
  - Status: Implemented.
- Session create data extraction issues
  - Evidence: `session/create.rs` uses args plus payload fallback.
  - Status: Implemented.
- Agent data parsing broken
  - Evidence: `agent.rs` validates JSON object and logs activity.
  - Status: Implemented.

## High-Risk Mismatches — Resolution Status

1. Project API contract is broader than runtime behavior.
   - Status: **Known scope gap** — deferred to v0.3.0 project workflow.
   - `project.rs` supports get/list; broader actions return unsupported error.

2. ~~Lock abstraction has no concrete implementation.~~
   - **RESOLVED** (2026-02-12, `mcb-ah3e`): Lock/cache contracts aligned with
     implementation reality. Port surface constrained.

3. ~~Moka ignores per-entry cache config.~~
   - **RESOLVED** (2026-02-12, `mcb-ah3e`): Cache contract docs updated to
     reflect actual provider semantics. Per-entry config is not supported by
     Moka and the API contract now documents this.

4. ~~Plan docs still mark resolved items as open.~~
   - **RESOLVED** (2026-02-12, `mcb-ci21`): All stale plan docs reconciled.

## Pending Closure Matrix — Final Status

- ~~P0: Reconcile stale plan docs.~~ **CLOSED** (`mcb-ci21`, 2026-02-12).
- ~~P1: Implement concrete lock provider.~~ **CLOSED** (`mcb-ah3e`, 2026-02-12).
- ~~P1: Apply per-entry config in Moka.~~ **CLOSED** (`mcb-ah3e`, 2026-02-12).
- P0: Finish project workflow operations.
  - Status: **Deferred to v0.3.0** — project handler supports get/list only.
- P1: Re-run MCP E2E validation on v0.2.1.
  - Status: **Deferred** — full CI pipeline passes; E2E specific to MCP is v0.3.0 scope.
- ~~P2: Keep context snapshots synchronized.~~ **CLOSED** (`mcb-ci21`, 2026-02-12).

## No Longer True Blockers

- Context search resource is present in args and handler.
- ErrorPattern memory store/get paths are implemented.
- Session and agent handlers include structured payload validation.
- VCS repository listing is provider-based.

## Recommended Finish Sequence

1. Close project workflow parity gap first.
2. Run fresh MCP validation and capture results in docs.
3. Reconcile all gap/plan docs to reflect current implementation.
4. Resolve lock/cache consistency gaps for multi-agent reliability.
5. Update this file after each closure step with commit evidence.

## Recovery Notes

- Branch snapshot: `release/v0.2.1`.
- Prior context sync commit: `347fefdc`.
- This file is the primary recovery index for v0.2.1 closure.

## Update Notes

- 2026-02-11: Added evidence-backed history and pending closure matrix.
- 2026-02-12: Reconciled all resolved items. Lock, cache, and doc drift issues
  closed. Remaining items deferred to v0.3.0 with rationale.
