# v0.2.2 History And Pending Closure Matrix

Last updated: 2026-02-11 (America/Sao_Paulo)

## Purpose

Reconstruct v0.2.2 implementation history, reconcile plan docs vs code,
and list pending closure work with source evidence.

## Evidence Base

- Planning docs:
  - `docs/plan/MCB-GAPS-REPORT.md`
  - `docs/plan/MCB-COMPREHENSIVE-GAPS.md`
  - `docs/plan/MCB-VALIDATION-REPORT.md`
  - `docs/plan/OPENCODE-INTEGRATION-PLAN.md`
  - `docs/plan/OPENCODE-MCB-MIGRATION-PLAN.md`
- Release docs:
  - `docs/operations/CHANGELOG.md`
  - `docs/developer/ROADMAP.md`
  - `docs/v030-IMPLEMENTATION.md`
  - `docs/implementation/phase-9-roadmap.md`
- Code checks:
  - `crates/mcb-server/src/handlers/project.rs`
  - `crates/mcb-server/src/handlers/search.rs`
  - `crates/mcb-server/src/handlers/memory/handler.rs`
  - `crates/mcb-server/src/handlers/session/create.rs`
  - `crates/mcb-server/src/handlers/vcs/list_repos.rs`
  - `crates/mcb-providers/src/database/sqlite/memory_repository.rs`
  - `crates/mcb-application/src/use_cases/memory_service.rs`
  - `crates/mcb-providers/src/cache/moka.rs`
  - `crates/mcb-domain/src/ports/infrastructure/lock.rs`
- Branch history: `release/v0.2.2` through commit `347fefdc`.

## Historical Timeline

1. 2026-02-08: gap and migration docs reported multiple P0/P1 blockers.
2. 2026-02-09/10: release history shows handler and gap-fix work landed.
3. 2026-02-10: `v0.2.0` tag and changelog report stabilization and
   `gap_fixes_e2e.rs` coverage.
4. 2026-02-11: branch received admin feature commits and context-hierarchy
   commit `347fefdc`.

## Reconciliation Matrix

- Project handler fully stubbed
  - Evidence: `project.rs` implements list/get for project resource.
  - Status: Partial.
- Context search resource missing
  - Evidence: `SearchResource::Context` plus handler branch exists.
  - Status: Implemented.
- ErrorPattern memory not implemented
  - Evidence: memory handler and service implement store/search paths.
  - Status: Implemented.
- VCS list returned collections
  - Evidence: `list_repos.rs` uses `VcsProvider::list_repositories`.
  - Status: Implemented.
- Memory FK parent instability
  - Evidence: SQLite repo ensures org/project before inserts.
  - Status: Implemented.
- Session create data extraction issues
  - Evidence: `session/create.rs` uses args plus payload fallback.
  - Status: Implemented.
- Agent data parsing broken
  - Evidence: `agent.rs` validates JSON object and logs activity.
  - Status: Implemented.

## High-Risk Mismatches Still Open

1. Project API contract is broader than runtime behavior.
   - Contract: `ProjectAction` and `ProjectResource` include create/update/
     delete and phase/issue/dependency/decision.
   - Runtime: `project.rs` supports only get/list project metadata and returns
     unsupported action errors for other combinations.

2. Lock abstraction has no concrete implementation.
   - Contract exists in `lock.rs`.
   - No `impl LockProvider for ...` found in code search.

3. Moka ignores per-entry cache config.
   - `set_json(..., _config: CacheEntryConfig)` discards `_config`.
   - Per-entry TTL/policy cannot be enforced for this provider.

4. Plan docs still mark resolved items as open.
   - Without reconciliation, teams can re-open solved work accidentally.

## Pending Closure Matrix

- P0: Finish project workflow operations.
  - Why: args contract is broader than handler capability.
  - Evidence: `consolidated.rs`, `project.rs`.
- P0: Reconcile stale plan docs.
  - Why: avoid false pending reports.
  - Evidence: `docs/plan/*.md`.
- P1: Implement concrete lock provider.
  - Why: needed for multi-agent coordination.
  - Evidence: `lock.rs`.
- P1: Apply per-entry config in Moka.
  - Why: provider currently ignores entry config.
  - Evidence: `moka.rs`.
- P1: Re-run MCP E2E validation on v0.2.2.
  - Why: this pass is doc+code reconciliation only.
  - Evidence: `gap_fixes_e2e.rs`.
- P2: Keep context snapshots synchronized.
  - Why: avoid future recovery drift.
  - Evidence: `context/project-intelligence/*.md`.

## No Longer True Blockers

- Context search resource is present in args and handler.
- ErrorPattern memory store/get paths are implemented.
- Session and agent handlers include structured payload validation.
- VCS repository listing is provider-based.

## Recommended Finish Sequence

1. Close project workflow parity gap first.
2. Run fresh MCP validation and capture results in docs.
3. Reconcile all gap/plan docs to reflect current implementation.
4. Resolve lock/cache consistency gaps for multi-agent reliability.
5. Update this file after each closure step with commit evidence.

## Recovery Notes

- Branch snapshot: `release/v0.2.2`.
- Prior context sync commit: `347fefdc`.
- This file is the primary recovery index for v0.2.2 closure.

## Update Notes

- 2026-02-11: Added evidence-backed history and pending closure matrix.
