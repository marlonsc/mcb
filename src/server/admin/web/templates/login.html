{% import "icons.html" as icons %}
<!DOCTYPE html>
<html lang="en" x-data="loginForm()" :class="{ 'dark': localStorage.getItem('theme') === 'dark' }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - MCP Context Browser</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="/static/admin.css">
    <script src="/static/admin.js"></script>
    <script>tailwind.config = { darkMode: 'class' }</script>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center py-12 px-4">
    <div class="max-w-md w-full space-y-6">
        <!-- Header -->
        <div class="text-center">
            <div class="icon-box icon-box-lg icon-box-primary mx-auto">
                {{ icons::icon(name="lock", class="icon-xl") }}
            </div>
            <h2 class="mt-6 text-3xl font-bold text-gray-900 dark:text-white">Admin Access</h2>
            <p class="mt-2 text-sm text-muted">Sign in to access the MCP Context Browser admin panel</p>
        </div>

        <!-- Login Form -->
        <form @submit.prevent="login()" class="mt-6 space-y-6">
            <div class="card">
                <div class="card-body space-y-4">
                    <div>
                        <label class="input-label">Username</label>
                        <input x-model="credentials.username" type="text" autocomplete="username" required class="input">
                    </div>
                    <div>
                        <label class="input-label">Password</label>
                        <input x-model="credentials.password" type="password" autocomplete="current-password" required class="input">
                    </div>

                    <!-- Error Alert -->
                    <div x-show="error" x-cloak class="alert alert-danger text-sm" x-text="error"></div>

                    <!-- Submit Button -->
                    <button type="submit" :disabled="loading" class="btn btn-primary w-full">
                        <span x-show="!loading">Sign in</span>
                        <span x-show="loading" class="flex items-center justify-center">
                            <span class="spinner spinner-sm mr-2"></span> Signing in...
                        </span>
                    </button>
                </div>
            </div>

            <p class="text-center text-sm text-muted">
                Default: <code class="code">admin / admin</code>
            </p>
        </form>
    </div>
</body>
<script>
function loginForm() {
    return {
        credentials: { username: '', password: '' },
        loading: false,
        error: '',

        async login() {
            this.loading = true;
            this.error = '';
            try {
                const data = await API.post('/admin/auth/login', this.credentials);
                if (data.success) {
                    auth.setToken(data.data.token);
                    window.location.href = '/dashboard';
                } else {
                    this.error = data.error || 'Login failed';
                }
            } catch (e) {
                this.error = e.message || 'Network error. Please try again.';
            }
            this.loading = false;
        }
    };
}
</script>
</html>
