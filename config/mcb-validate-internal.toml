# MCB Project-Specific Validation Configuration
# Overrides for .mcb-validate.toml.example defaults

[general]
workspace_root = "."
rules_path = "crates/mcb-validate/rules"
project_prefix = "mcb"
internal_dep_prefix = "mcb-"
skip_dir_patterns = ["/fixtures/"]
exclude_patterns = ["target/", "tests/fixtures/", "seaorm/entities/"]

[rules.architecture]
enabled = true

[rules.architecture.layer_boundaries]
application_internal_deps = ["mcb-domain"]
providers_internal_deps = ["mcb-domain"]
infrastructure_internal_deps = ["mcb-domain", "mcb-providers"]
server_internal_deps = ["mcb-domain", "mcb-infrastructure"]

[rules.naming]
enabled = true
excluded_crates = ["mcb-validate"]
variable_pattern = "^[a-z][a-z0-9_]*$"
function_pattern = "^[a-z][a-z0-9_]*$"
struct_pattern = "^[A-Z][a-zA-Z0-9]*$"
enum_pattern = "^[A-Z][a-zA-Z0-9]*$"
trait_pattern = "^[A-Z][a-zA-Z0-9]*$"
const_pattern = "^[A-Z][A-Z0-9_]*$"
module_pattern = "^[a-z][a-z0-9_]*$"
server_crate = "mcb-server"
domain_crate = "mcb-domain"
infrastructure_crate = "mcb-infrastructure"
application_crate = ""
providers_crate = "mcb-providers"
validate_crate = "mcb-validate"

[rules.kiss]
enabled = true
excluded_crates = ["mcb-validate"]
skip_file_patterns = [
    "/admin/api.rs",
    "/di/bootstrap.rs",
    "/di/catalog.rs",
    "/di/resolver.rs",
    "/health.rs",
]

[rules.refactoring]
enabled = true
excluded_crates = ["mcb-validate"]
generic_type_names = [
    "Error",
    "Result",
    "T",
    "U",
    "V",
    "E",
    "Context",
    "Config",
    "State",
]
utility_types = [
    "DateTime",
    "Duration",
    "Uuid",
    "PathBuf",
    "Option",
    "Vec",
    "String",
    "HashMap",
    "Arc",
    "Mutex",
]
skip_files = ["mod.rs", "lib.rs", "main.rs", "errors.rs", "error.rs"]
skip_dir_patterns = ["/fixtures/"]
known_migration_pairs = [["mcb-core", "mcb-domain"], ["mcb-std", "mcb-common"]]

[rules.performance]
enabled = true
excluded_crates = ["mcb-validate"]

[rules.patterns]
enabled = true
excluded_crates = ["mcb-validate"]
result_check_excluded_crates = ["mcb-providers"]
arc_pattern = "Arc<([A-Z][a-zA-Z0-9_]*)>"
allowed_concrete_types = ["String", "Vec", "HashMap", "RwLock", "Mutex"]
provider_trait_suffixes = ["Provider", "Repository", "Service", "UseCase"]

[rules.test_quality]
enabled = true
excluded_paths = ["mcb-validate/src/"]

[rules.implementation]
enabled = true
excluded_crates = []

[rules.quality]
enabled = true
max_file_lines = 800
excluded_paths = [
    "mcb-providers/src/vector_store/",
    "mcb-providers/src/embedding/",
]

[rules.clean_architecture]
enabled = true
domain_dependencies = []
application_dependencies = []
infrastructure_dependencies = ["mcb-domain"]
server_path = "crates/mcb-server/src"
handlers_path = "crates/mcb-server/src/handlers"
domain_path = "crates/mcb-domain/src"
entities_path = "crates/mcb-domain/src/entities"
vo_path = "crates/mcb-domain/src/value_objects"
infrastructure_path = "crates/mcb-infrastructure/src"
application_path = ""
ports_providers_path = "crates/mcb-domain/src/ports"
identity_skip_suffixes = ["Builder", "Options", "Config", "Changes", "Filter"]

[rules.solid]
enabled = true

[rules.organization]
enabled = true
server_exempt_files = ["auth.rs", "middleware.rs"]

[rules.visibility]
enabled = true
scan_crates = [
    "mcb-domain",
    "mcb-providers",
    "mcb-infrastructure",
    "mcb-server",
]

[rules.layer_flow]
enabled = true

[rules.port_adapter]
enabled = true

[rules.dependency]
enabled = true

[[rules.dependency.bypass_boundaries]]
violation_id = "DEP004"
scan_root = "crates/mcb-server/src/admin"
pattern = "mcb_domain::ports::repositories"
allowed_files = [
    "crates/mcb-server/src/admin/crud_adapter.rs",
    "crates/mcb-server/src/admin/handlers.rs",
]

[[rules.dependency.bypass_boundaries]]
violation_id = "DEP005"
scan_root = "crates/mcb/src/cli"
pattern = "mcb_validate::"
allowed_files = ["crates/mcb/src/cli/validate.rs"]

[validators]
architecture = true
clean_architecture = true
dependency = true
documentation = true
implementation = true
kiss = true
layer_flow = true
naming = true
organization = true
patterns = true
performance = true
port_adapter = true
quality = true
refactoring = true
solid = true
test_quality = true
visibility = true
