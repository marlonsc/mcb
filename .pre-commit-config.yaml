# Pre-commit: same checks as CI (ci.yml) to avoid pushing broken code
# Install: pre-commit install
# Run manually: pre-commit run --all-files
# CI runs: lint (CI_MODE=1), test, validate (STRICT=1), audit, docs
default_language_version:
  python: python3

repos:
  - repo: local
    hooks:
      - id: make-fmt
        name: make fmt
        entry: make fmt
        language: system
        pass_filenames: false
      - id: make-lint
        name: make lint (CI_MODE=1)
        entry: bash -c 'make lint CI_MODE=1'
        language: system
        pass_filenames: false
      - id: make-test
        name: make test (TEST_THREADS=4)
        entry: bash -c 'make test SCOPE=all TEST_THREADS=4'
        language: system
        pass_filenames: false
      - id: make-validate
        name: make validate (STRICT=1)
        entry: bash -c 'make validate STRICT=1'
        language: system
        pass_filenames: false
      - id: make-audit
        name: make audit
        entry: make audit
        language: system
        pass_filenames: false
      - id: make-docs
        name: make docs
        entry: make docs
        language: system
        pass_filenames: false
