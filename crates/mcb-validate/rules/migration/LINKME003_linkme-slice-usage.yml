schema: "rule/v1"
id: "LINKME003"
name: "Linkme Slice Usage"
category: "dependency_injection"
severity: "warning"
enabled: true
engine: "rust-rule-engine"

description: "Provider registration missing #[linkme::distributed_slice(NAME)] attribute"
rationale: "All provider implementations must be registered via linkme slices"

rule: |
  rule LinkmeSliceUsage "Check for linkme slice usage" {
      when
          ProviderImplementation() &&
          !HasAttribute("linkme::distributed_slice(")
      then
          Violation("Provider registration missing #[linkme::distributed_slice(NAME)] attribute");
  }