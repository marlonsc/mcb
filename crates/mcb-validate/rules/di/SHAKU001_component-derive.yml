schema: "rule/v1"
id: "SHAKU001"
name: "Component Derive Required"
category: "dependency_injection"
severity: "error"
enabled: true
engine: "rust-rule-engine"

description: "Port implementation missing #[derive(Component)]"
rationale: "All port implementations must be Shaku components for DI"

rule: |
  rule ComponentDeriveRequired "Check for Component derive" {
      when
          AST.Struct(implements_port == true) &&
          !HasAttribute("derive(Component)")
      then
          Violation("Port implementation missing #[derive(Component)]");
  }