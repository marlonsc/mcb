_template: "cargo_dependency_check"
id: "CA014"
name: "Validator Crate Boundaries"
category: "architecture"
severity: "error"
enabled: true
engine: "rust-rule-engine"

description: "mcb-validate is a standalone analysis crate"
rationale: "Validation logic may depend on domain utilities but not application layers"

crate_name: "{{validate_crate}}"
forbidden_prefixes: []
allowed_dependencies: ["{{domain_crate}}"]

config:
  crate_name: "{{validate_crate}}"
  forbidden_prefixes: []
  allowed_dependencies: ["{{domain_crate}}"]

rule: |
  rule ValidatorBoundaries "Validator Crate Boundaries" {
      when
          Facts.crate_name == "{{validate_crate}}" &&
          Facts.crate_{{validate_module}}_depends_on_{{application_module}} == true
      then
          Facts.violation_triggered = true;
          Facts.violation_message = "Validator crate cannot depend on application layer";
          Facts.violation_rule_name = "CA014";
  }
